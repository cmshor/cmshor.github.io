<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Fun with spicy numbers</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Initialize!'});
    </script>
  </head>
  <body>

<h1>Sgt. Pepper's Packaging Planner</h1>
    <h3>Hello PfT workshop participants and aspiring pepper entrepreneurs!</h3>
    <p>On this webpage, you can visualize spicy numbers in a rectangular array. Specify the pack numbers along with the number of rows and columns you want to see.</p>
    <p>The default display orders the numbers as increasing from left to right until the end of a row, then goes up one row, continuing from left to right. </p>
    <p>If you want a snake-style display (increasing from left to right on the bottom row, then from right to left on the row above, then left to right on the row above that, etc.), select the "snake style" checkbox.</p>

     Click the Initialize button to get started.
    <p>
    <div id="mycell"><script type="text/x-sage">
@interact
def picture_time(str1=input_box('[6,14,21]', type = str, width=40, label='pack numbers'),
                 str2=input_box('7', type = str, width=10, label='number of rows'),
                 str3=input_box('8', type = str, width=10, label='number of columns'),
                 snake=checkbox(False, label='snake style')):
    gens=eval(str1)
    rows=eval(str2)
    columns=eval(str3)
    
    def add_lists(L1,L2,max):
        L=[]
        for l1 in L1:
            for l2 in L2:
                if l1+l2<=max:
                    L.append(l1+l2)
        return(L)

    def get_multiples(a,max):
        i=0
        L=[]
        while a*i<=max:
            L.append(a*i)
            i+=1
        return(L)

    def get_elts(gens,max): # this creates the numerical semigroup generated by elements in the list 'gens'
        k=len(gens)
        if k==1:
            a=gens[0]
            i=0
            L=[]
            while i*a<=max:
                L.append(i*a)
                i+=1
            return(L)
        if k==2:
            a=gens[0]
            b=gens[1]
            L1=get_multiples(a,max)
            L2=get_multiples(b,max)
            L=add_lists(L1,L2,max)
            return(set(L))
        if k>2:
            z=gens[k-1]
            newgens=gens[:-1]
            Lk=get_multiples(z,max)
            return(set(add_lists(get_elts(newgens,max),Lk,max)))  
    
    def make_unit_square(i,j,spicy):
        if spicy:
            return(polygon([(i,j),(i+1,j),(i+1,j+1),(i,j+1)],fill=True,color="#DC3220"))
        else:
            return(polygon([(i,j),(i+1,j),(i+1,j+1),(i,j+1)],fill=True,color="#005AB5"))

    def make_grid(rows,columns):
        P=plot([],axes=False,aspect_ratio=True)
        for j in range(columns+1):
            P+=line([(j,0),(j,rows)],color="black")
        for i in range(rows+1):
            P+=line([(0,i),(columns,i)],color="black")
        return(P)

    def build_picture(elts,rows,columns,snake=False):
        max=rows*columns-1
        var('i,j')
        P=plot([],axes=False,aspect_ratio=True)
        for j in range(rows):
            for i in range(columns):
                z=i+j*columns
                if snake==False:
                    P+=make_unit_square(i,j,z in elts)
                    P+=text(str(z),(i+1/2,j+1/2),color="#F0FF3F",fontsize="medium")
                if snake==True:
                    col_num = (1+(-1)^j)*i/2 + (1-(-1)^j)*(columns-1-i)/2 # reverse order on odd rows
                    P+=make_unit_square(col_num,j,z in elts)
                    P+=text(z,(col_num+1/2,j+1/2),color="#F0FF3F",fontsize="medium")
        P+=make_grid(rows,columns)
        return(P)

    max=rows*columns
    elts = get_elts(gens,max)
    show(build_picture(elts,rows,columns,snake))
    elts_complement = []
    for i in range(max):
        if i not in elts:
            elts_complement.append(i)
    print("Given pack numbers " + str(gens) + ", in the image above the red squares represent spicy numbers")
    print("and the blue squares represent bland numbers.")
    print("")
    print("Among integers from 0 to " + str(max-1) + ", the following are bland: ")
    print(elts_complement)
</script></div></p>
<p>Note: It's easy to break this! If the numbers of rows and columns aren't positive integers, it'll get stuck. Same goes if they're too big! And same if the pack numbers aren't all positive integers written in a list with square brackets. If it gets stuck, hit the Initialize button to restart.</p>
<p>This visualizer was created in <a href="https://www.sagemath.org">SageMath</a> by <a href="https://cshor.org">Caleb Shor</a> in May 2024. SageMath is free! Try it out at <a href="https://cocalc.com">CoCalc</a>. (And feel free to copy the code for this application from this page's html source.)</p>
<p>If you're wondering what spicy numbers are, here's the story. Starting with a list of numbers ("pack numbers"), a spicy number is one which can be written as a sum of pack numbers (allowing for repetition, and they don't all have to appear).</p>
  </body>
</html>
